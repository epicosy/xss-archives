CVE-2015-3161: search bar does not escape </script> tags when producing JSON

BugZilla Report: The search bar code for emitting the "search object" onto the page (JS object defining all possible search fields, operations, and values) does not correctly escape </script> tags appearing in string literals. If the admin defines a key type or arch containing </script>... it will appear unescaped in the page. Basically a dupe of bug 1209736 because the search bar code is not using tg.to_json like everything else. Version-Release number of selected component (if applicable): affects all Beaker versions since 2011 or earlier How reproducible: with admin access. Steps to Reproduce: 1. As an admin, add a key type: <script>alert('xss')</script> 2. Go to the systems page. Actual results: 'xss' alert appears. </script> is unescaped inside the JS string literal. Expected results: </script> is escaped correctly.

SecurityFocus Discussion: Beaker is prone to an HTML-injection vulnerability because it fails to sufficiently sanitize user-supplied input. An attacker may leverage these issues to execute arbitrary HTML and script code in the browser of an unsuspecting user in the context of the affected site. This may let the attacker steal cookie-based authentication credentials and launch other attacks. Vulnerable: Beaker Project Beaker 0.6, 0.7, 0.8, 0.9, 0.10, 011, 0.12, 0.13, 0.14, 0.15, 0.16, 0.17, 0.18, 1.0, 19.0, 20.0.

